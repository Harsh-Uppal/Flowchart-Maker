var generalInputs,canvas,pos=vector(0,0),cellSize=50,panSpeed=.5,cellSizeSpeed=.02,maxCellSize=200,minCellSize=10,dragEnabled=!0,shiftPressed=!1,updateOnMouseMoved=!0;const flowchartItems=[],connectorQuality=30;function setup(){const e=createCanvas(window.innerWidth,window.innerHeight);e.mouseWheel(changeZoom),(generalInputs=loadInputs()).zoom.max=maxCellSize,generalInputs.zoom.min=minCellSize,canvas=document.querySelector("canvas"),setCursor("grab"),update(),noLoop()}function loadInputs(){return{zoom:document.querySelector(".generalProperties > .zoom > input"),gridlines:document.querySelector(".generalProperties > .gridlines > input"),gridColor:document.querySelector(".generalProperties > .gridlinesColor > input"),bgColor:document.querySelector(".generalProperties > .backgroundColor > input")}}function drawGridlines(){strokeWeight(2);for(let e=pos.x%cellSize;e<width;e+=cellSize)line(e,0,e,height);for(let e=pos.y%cellSize;e<height;e+=cellSize)line(0,e,width,e)}function mouseDragged(e){"CANVAS"==e.srcElement.nodeName&&dragEnabled&&(pos=vector(pos.x-(pmouseX-mouseX)*panSpeed,pos.y-(pmouseY-mouseY)*panSpeed),pmouseX=mouseX,pmouseY=mouseY,update(),updateFlowchartPos(),setCursor("grabbing"))}function mouseMoved(e){updateOnMouseMoved&&(pmouseX=mouseX,pmouseY=mouseY,shiftPressed=e.shiftKey,update())}function mouseClicked(e){"CANVAS"==e.srcElement.nodeName&&(null!=FlowchartItem.connecting&&FlowchartItem.connecting.connectTo(FlowchartItem.connecting.index),update())}function mouseReleased(e){"CANVAS"==e.srcElement.nodeName&&setCursor("grab")}function changeZoom(e){generalInputs.zoom.value=cellSize=Math.round(Math.max(Math.min(null==e?parseInt(generalInputs.zoom.value):cellSize-e.deltaY*cellSizeSpeed,maxCellSize),minCellSize)),updateFlowchartPos(),update()}function setCursor(e){canvas.style.cursor!=e&&(canvas.style.cursor=e)}function update(){background(generalInputs.bgColor.value),stroke(generalInputs.gridColor.value),generalInputs.gridlines.checked&&drawGridlines(),stroke("#fff");for(let e=0;e<flowchartItems.length;e++)flowchartItems[e].update()}function updateFlowchartPos(){flowchartItems.forEach(e=>{e.updatePosition()})}window.addEventListener("resize",setup);